---
# Variables for mssql_inspec role

# Supported MSSQL versions
supported_mssql_versions:
  - "2008"
  - "2012"
  - "2014"
  - "2016"
  - "2018"
  - "2019"

# InSpec binary path
inspec_binary_path: "/usr/bin/inspec"

# Control file patterns
control_file_pattern: "*.rb"

# Result file format
result_format: "json-min"

# Environment variables matching original NIST.ksh script
# From NIST.ksh: export PATH=/usr/local/oracle/NIST_FILES/mssql-tools/bin:/tools/ver/sybase/OCS-16_0/bin:$PATH
# From NIST.ksh: export LD_LIBRARY_PATH=/tools/ver/oracle-19.16.0.0-64
mssql_environment:
  PATH: "/usr/local/oracle/NIST_FILES/mssql-tools/bin:/tools/ver/sybase/OCS-16_0/bin:{{ ansible_env.PATH }}"
  LD_LIBRARY_PATH: "/tools/ver/oracle-19.16.0.0-64:{{ ansible_env.LD_LIBRARY_PATH | default('') }}"
  INSPEC_BACKEND: "mssql"

# Timestamp formats matching original script exactly
# From NIST.ksh: export now=$(date +%Y_%m%d_%H%M%S)
# From NIST.ksh: export touch_time=$(date +%Y%m%d%H%M.%S)
timestamp_format: "%Y_%m%d_%H%M%S"
touch_time_format: "%Y%m%d%H%M.%S"
splunk_time_format: "%Y-%m-%d %H:%M:%S"

# File naming patterns matching original script
# Original: ${platform}_NIST_$$_${servernm}_${dbname}_${dbversion}_${now}_${file_prefix}.json
file_name_template: "MSSQL_NIST_{{ ansible_process_id }}_{{ mssql_server }}_{{ mssql_database }}_{{ mssql_version }}_{{ timestamp }}"
temp_dir_template: "MSSQL_NIST_{{ ansible_process_id }}_{{ timestamp }}_temp_files"

# Directory structure matching original script
# From NIST_for_db.ksh: ruby_dir=$script_dir/${platform}_${dbversion}_ruby
controls_dir_pattern: "MSSQL{{ mssql_version }}_ruby"
log_dir_pattern: "MSSQLNIST"

# Process execution settings
parallelism: 3
max_parallelism: 12

# Error messages
error_messages:
  missing_params: "Required MSSQL connection parameters are missing"
  inspec_not_installed: "InSpec is not installed. Please install InSpec before running this role."
  unsupported_version: "MSSQL version is not supported"
  connection_failed: "Cannot connect to database. Please verify connection parameters."
  password_retrieval_failed: "Unable to retrieve password from secure store"
  ruby_dir_missing: "The directory specified as ruby_dir for Database Platform MSSQL in the script does not exist or the permissions to access the directory are insufficient."
  
# JSON error templates matching original script exactly
json_templates:
  connection_error: |
    {"controls":[{"timestamp":"","hostname":"{{ mssql_server }}","database":"{{ mssql_database }}","port":"{{ mssql_port }}","DBVersion":"{{ mssql_version }}","id":"Cannot connect to database. One or more parameters such as Platform, Host Name, Database Name, Service Name, Port Number, Database Version may be incorrect.","profile_id":"N/A","profile_sha256":"N/A","status":"Unreachable","code_desc":"Cannot connect","statistics":{"duration":0},"version":"N/A"}]}
  cloakware_unreachable: |
    {"controls":[{"timestamp":"","hostname":"{{ mssql_server }}","database":"{{ mssql_database }}","port":"{{ mssql_port }}","DBVersion":"{{ mssql_version }}","id":"Not able to retrieve Cloakware Password for DBMAINT Account","profile_id":"N/A","profile_sha256":"N/A","status":"Unreachable","code_desc":"N/A","statistics":{"duration":0},"version":"N/A"}]}

# InSpec execution settings
inspec_settings:
  reporter: "json-min"
  no_color: true
  backend: "mssql"
  timeout: 300
